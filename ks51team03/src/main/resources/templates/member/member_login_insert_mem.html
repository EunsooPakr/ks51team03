<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAL 회원가입 폼</title>
    <link rel="stylesheet" type="text/css" th:href="@{/assets/font/iconic/css/material-design-iconic-font.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/member_custom.css}" >
</head>
<body>
    <div class="member-insert-form-body">
    <!-- <div class="member-insert-form"> -->
    <form class="member-insert-form" id="insertMemberForm" th:action="@{/member/InsertMember}" method="post">
       <!-- 로고 -->		
		<a href="/member/member_main" class="logo-single">
			<img th:src="@{/assets/img/pal_logo.png}" alt="IMG-LOGO">
		</a>

        <!-- 2. 필드 -->
        <div class="login-insert-field-id">
            <b>아이디</b>
            <div>
                <input type="text" id="memberId" placeholder="아이디 입력">
                <input type="button" id="idCheck" value="중복검사">
            </div>
            <a id="idCheckResult" style="display: none;"></a>
        </div>
        <div class="login-insert-field">
            <b>비밀번호</b>
            <input class="userpw" type="password" id="memberPw">
        </div>
        <div class="login-insert-field">
            <b>비밀번호 재확인</b>
            <input class="userpw-confirm" type="password">
             <a id="passwordMatchResult" style="display: none;"></a> <!-- 결과를 출력할 <a> 태그 -->
        </div>
        
        
        <div class="login-insert-field">
            <b>이름</b>
            <input type="text" id="memberName">
        </div>

 		<!-- 4. 필드(성별) -->
        <b>성별</b>
        <div class="login-insert-field-button gender">
		    <button class="login-insert-field-button-child gender-btn">남자</button>
		    <button class="login-insert-field-button-child gender-btn">여자</button>
		    <button class="login-insert-field-button-child gender-btn">선택안함</button>
		</div>


		<!-- 5. 이메일_전화번호 -->
        <div class="login-insert-field">
            <b>본인 확인 이메일<!-- <small>(선택)</small> --></b>
            <input type="email">
        </div>


        <!-- 3. 필드(생년월일) -->
        <div class="login-insert-field birth">
            <b>생년월일</b>
            <div>
                <input type="number" placeholder="년(4자)" id="memberBirth">                
                <select>
                    <option value="">월</option>
                    <option value="">1월</option>
                    <option value="">2월</option>
                    <option value="">3월</option>
                    <option value="">4월</option>
                    <option value="">5월</option>
                    <option value="">6월</option>
                    <option value="">7월</option>
                    <option value="">8월</option>
                    <option value="">9월</option>
                    <option value="">10월</option>
                    <option value="">11월</option>
                    <option value="">12월</option>
                </select>
                <input type="number" placeholder="일">
            </div>
        </div>


		<div class="login-insert-field-addr">
            <b>주소</b>
            <div>
                <input type="number" placeholder="우편번호 입력">
                <input type="button" value="검색">
            </div>
            <input type="text" placeholder="주소를 입력하세요">
            <input type="text" placeholder="상세주소를 입력하세요">
        </div>



		<!-- 4. 필드(반려동물 유무) -->
        <b>반려동물 유무</b>
		<div class="login-insert-field-button">
			<button class="login-insert-field-button-child pet-btn">있다</button>
		    <button class="login-insert-field-button-child pet-btn">없다</button>
		</div>
        
        
        <div class="login-insert-field-tel-number">
        	<br><br>
            <b>휴대전화</b>
            <div>
                <input type="tel" placeholder="전화번호 입력" id=memberPhone>
                <input type="button" value="인증번호 받기">
            </div>
            <input type="number" placeholder="인증번호를 입력하세요">
            <a>인증이 완료되었습니다.</a>
        </div>

        <!-- 6. 가입하기 버튼 -->
        <input type="submit" value="가입하기" id="addBtn">

        <!-- 7. 푸터 -->
        <div class="member-insert-form-footer">
            <div>
                <a href="#none">이용약관</a>
                <a href="#none">개인정보처리방침</a>
                <a href="#none">회원정보 고객센터</a>
            </div>
            <span><a href="#none">PALCorp.</a></span>
        </div>
	</form>
   </div>

<script th:src="@{/assets/js/jquery-3.7.1.js}"></script>
<script th:inline="javascript">
    /* Thymeleaf 내부에서 JavaScript 사용 */
    document.addEventListener('DOMContentLoaded', function() {
        var genderButtons = document.querySelectorAll('.gender-btn');
        var petButtons = document.querySelectorAll('.pet-btn');

        // 성별 버튼 클릭 시 처리
        genderButtons.forEach(function(button) {
            button.addEventListener('click', function() {
                // 선택된 버튼에 active 클래스 추가
                genderButtons.forEach(function(btn) {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
            });
        });

        // 반려동물 유무 버튼 클릭 시 처리
        petButtons.forEach(function(button) {
            button.addEventListener('click', function() {
                // 선택된 버튼에 active 클래스 추가
                petButtons.forEach(function(btn) {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
            });
        });
    });
    
    /*아이디 중복 검사*/
    $('#idCheck').click(function(){
        const memberId = $('#memberId').val();
        if (!memberId) {
            /* alert('회원아이디를 입력해주세요'); */
            $('#memberId').focus();
            return ;
        }
        const request = $.ajax({
            url : '/member/idCheck',
            method : 'POST',
            data : { 'memberId' : memberId },
            dataType : 'json'
        });
        request.done(response => {
            const isMember = response;
            
            $('#addMemberForm input').not('#memberId').prop('disabled', isMember);            
            $('#addMemberForm select').prop('disabled', isMember);            
            $('#addMemberForm button').not('#idCheck').prop('disabled', isMember);
            
            const idCheckResult = $('#idCheckResult');
            if (isMember) {
                idCheckResult.text('회원가입을 할 수 없는 아이디입니다.');
                idCheckResult.show(); // 결과 메시지 출력
                $('#memberId').val('');
                $('#memberId').focus();
            } else {
                idCheckResult.text('사용 가능한 아이디입니다.');
                idCheckResult.show(); // 결과 메시지 출력
            }
        });
        request.fail((jqXHR, textStatus, error) => {
            console.log(jqXHR, textStatus, error);
        });
    });
    
    /*비밀번호 재확인*/
     $('.userpw-confirm').keyup(function() {
        var password = $('.userpw').val(); // 첫 번째 비밀번호 입력 값
        var confirmPassword = $(this).val(); // 비밀번호 재확인 입력 값
        
        var passwordMatchResult = $('#passwordMatchResult');
        
        if (password === confirmPassword) {
            passwordMatchResult.text('비밀번호가 일치합니다.');
            passwordMatchResult.css('color', 'green'); // 일치 시 글자색 초록색으로 변경
            passwordMatchResult.show();
        } else {
            passwordMatchResult.text('비밀번호가 일치하지 않습니다.');
            passwordMatchResult.css('color', 'red'); // 불일치 시 글자색 빨간색으로 변경
            passwordMatchResult.show();
        }
    });
    
  	// 첫 번째 비밀번호 입력 필드의 keyup 이벤트 처리
     $('.userpw').keyup(function() {
         // 비밀번호가 변경될 때마다 결과 메시지 숨기기
         $('#passwordMatchResult').hide();
     });
  	
  	
  	// 회원가입
	$('#addBtn').click(function(){
		let isSubmit = true;
		
		$('#addMemberForm input, #addMemberForm select').each( (idx, element) => {
			const id = element.id;
			const value = element.value;
			if(!value){
				alert('필수입력 항목입니다.');
				$(element).focus();
				isSubmit = false;
				return false;
			}
		});
		
		if(isSubmit) $('#addMemberForm').submit();
	});
</script>
</body>